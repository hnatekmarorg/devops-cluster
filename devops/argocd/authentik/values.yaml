# Authentik configuration values
# This follows the same pattern as other applications in this cluster

# Use environment variables from existing authentik-init secret
authentik:
  env:
    - name: AUTHENTIK_SECRET_KEY
      valueFrom:
        secretKeyRef:
          name: authentik-init
          key: SECRET_KEY
  redis:
    enabled: true

postgresql:
  enabled: true
  architecture: standalone
  env:
    - name: POSTGRES_PASSWORD
      valueFrom:
        secretKeyRef:
          name: authentik-init
          key: database_postgres_password
  image:
    tag: "17.6-bookworm"

redis:
  enabled: true
  architecture: standalone
  auth:
    enabled: false
  image:
    registry: docker.io
    repository: library/redis
    tag: "8.2.1"



# Server configuration
server:
  ingress:
    enabled: true
    className: "nginx"
    hosts:
      - host: authentik.hnatekmar.dev
        paths:
          - path: /
            pathType: Prefix
    tls:
      - hosts:
          - authentik.hnatekmar.dev
        secretName: authentik-tls
    annotations:
      cert-manager.io/cluster-issuer: letsencrypt-cloudflare
      nginx.ingress.kubernetes.io/rewrite-target: /
  service:
    type: ClusterIP
    port: 9000

# Service Account
serviceAccount:
  create: true
  name: authentik

# Worker configuration
worker:
  replicas: 1

# Resource limits (adjust based on your needs)
resources:
  requests:
    memory: "512Mi"
    cpu: "250m"
  limits:
    memory: "2Gi"
    cpu: "1000m"