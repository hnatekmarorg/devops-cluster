# Image configuration - using tb-postgres variant with PostgreSQL
image:
  repository: thingsboard/tb-postgres
  tag: "2.2"
  pullPolicy: IfNotPresent

# Service configuration
service:
  type: ClusterIP
  port: 8080

# Ingress configuration following repository standards
ingress:
  enabled: true
  annotations:
    cert-manager.io/cluster-issuer: letsencrypt-cloudflare
  ingressClassName: nginx
  hosts:
    - host: thingsboard.hnatekmar.dev
      paths:
        - path: /
          pathType: Prefix
  tls:
    - hosts:
        - thingsboard.hnatekmar.dev
      secretName: thingsboard-tls

# Database configuration (embedded PostgreSQL)
database:
  type: postgres
  host: localhost
  port: 5432
  name: thingsboard

# Persistence configuration using NFS storage class
persistence:
  enabled: true
  storageClassName: nfs-client
  accessMode: ReadWriteMany
  size: 10Gi
  mountPath: /data

# RabbitMQ configuration (chart dependency)
rabbitmq:
  enabled: true
  auth:
    username: thingsboard
    password: thingsboard123
  persistence:
    enabled: true
    storageClass: longhorn
    size: 5Gi

# Resource limits and requests
resources:
  requests:
    memory: "2Gi"
    cpu: "1000m"
  limits:
    memory: "4Gi"
    cpu: "2000m"

# Probes configuration
readinessProbe:
  enabled: true
  initialDelaySeconds: 60
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 3

livenessProbe:
  enabled: true
  initialDelaySeconds: 120
  periodSeconds: 30
  timeoutSeconds: 5
  failureThreshold: 5

# Replica configuration
replicaCount: 1

# Security context
securityContext:
  runAsNonRoot: false
  fsGroup: 1000
